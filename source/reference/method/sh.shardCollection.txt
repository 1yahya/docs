====================
sh.shardCollection()
====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

.. method:: sh.shardCollection(namespace, key, unique)

   Shards a collection using the ``key`` as a the :term:`shard
   key`. :method:`sh.shardCollection()` takes the following arguments:

   .. list-table::
      :header-rows: 1
      :widths: 20 20 80
   
      * - Parameter
   
        - Type
   
        - Description
   
      * - ``namespace``
   
        - string
   
        - The :term:`namespace` of the collection to shard in the form
          ``<database>.<collection>``.
          
          
   
      * - ``key``
   
        - document
   
        - The index specification document to use as the shard key. The shard
          key determines how MongoDB distributes the documents among the shards.
          
          Unless the collection is empty, the index must exist prior to the
          :dbcommand:`shardCollection` command. If the collection is empty,
          MongoDB creates the index prior to sharding the collection if the
          index that can support the shard key does not already exist.
          
          See also :ref:`sharding-shard-key-indexes`
          
          
   
      * - ``unique``
   
        - boolean
   
        - When ``true``, the ``unique`` option ensures that the underlying index
          enforces a unique constraint. Hashed shard keys do not support unique
          constraints.
          
          
   

Considerations
--------------

.. include:: /includes/fact-cannot-unshard-collection.rst

Shard Keys
~~~~~~~~~~

Choosing the best shard key to effectively distribute load among your
shards requires some planning. Review :ref:`sharding-shard-key`
regarding choosing a shard key and restrictions.

Hashed Shard Keys
~~~~~~~~~~~~~~~~~

:ref:`Hashed shard keys <sharding-hashed-sharding>` use a
hashed index of a single field as the shard key.

Use the form ``{field: "hashed"}`` to specify a hashed shard key.
Hashed shard keys may not be compound indexes.

.. include:: /includes/note-hashed-shard-key-during-chunk-migration.rst

.. seealso:: :doc:`/core/hashed-sharding`

Uniqueness
~~~~~~~~~~

If specifying ``unique: true``:

.. include:: /includes/extracts/shard-collection-unique-restriction-method.rst

See also :ref:`Sharded Collection and Unique Indexes
<sharding-shard-key-unique>`
  
Example
-------

Given the ``people`` collection in the ``records`` database, the
following command shards the collection by the ``zipcode`` field:

.. code-block:: javascript

   sh.shardCollection("records.people", { zipcode: 1} )

.. seealso:: :dbcommand:`shardCollection`, :doc:`/sharding`

