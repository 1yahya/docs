========
applyOps
========

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. dbcommand:: applyOps

   Applies specified :term:`oplog` entries to a :binary:`~bin.mongod`
   instance. The :dbcommand:`applyOps` command is primarily an internal
   command to support :term:`sharded clusters <sharded cluster>`.

   The :dbcommand:`applyOps` command has the following prototype form:

   .. code-block:: javascript

      db.runCommand( { applyOps: [ <operations> ],
                       preCondition: [ { ns: <namespace>, q: <query>, res: <result> } ] } )

   The :dbcommand:`applyOps` command takes a document with the following fields:


   .. list-table::
      :header-rows: 1
      :widths: 20 20 80
   
      * - Field
   
        - Type
   
        - Description
   
      * - ``applyOps``
   
        - array
   
        - The oplog entries to apply.
          
          
   
      * - ``preCondition``
   
        - array
   
        - Optional. An array of documents that contain the conditions that must be true in order to apply the oplog entry. Each document contains a set of conditions, as described in the next table.
          
          
   


   The ``preCondition`` array takes one or more documents with the following fields:


   .. list-table::
      :header-rows: 1
      :widths: 20 20 80
   
      * - Field
   
        - Type
   
        - Description
   
      * - ``ns``
   
        - string
   
        - A :term:`namespace`. If you use this field, :dbcommand:`applyOps` applies oplog entries only for the :term:`collection` described by this namespace.
          
          
   
      * - ``q``
   
        - string
   
        - Specifies the :term:`query` that produces the results specified in the ``res`` field.
          
          
   
      * - ``res``
   
        - string
   
        - The results of the query in the ``q`` field that must match to apply the oplog entry.
          
          
   


.. include:: /includes/warning-blocking-global.rst

.. write-lock

.. see: DOCS-133; SERVER-4259
